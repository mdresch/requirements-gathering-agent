import type { ProjectContext } from '../../ai/types';

/**
 * Program Risk Register Template
 *
 * This template provides a comprehensive, PMO/PMBOK-compliant risk register for program-level risks.
 * It is designed to capture, assess, and manage risks that span multiple projects, business units, or the entire program lifecycle.
 * The scope is broader than a project risk register, including strategic, cross-project, portfolio, and enterprise risks.
 */
export class ProgramRiskRegisterTemplate {
  constructor(private context: ProjectContext) {}

  /**
   * Generate comprehensive Program Risk Register content with intelligent risk synthesis
   */
  generateContent(): string {
    const programName = this.context.programName || 'Program';
    const programManager = this.context.programManager || '[Program Manager]';
    const charterDate = new Date().toISOString().split('T')[0];
    return `# Program Risk Register\n\n**Generated by ADPA Enterprise Framework**  \n**Category:** risk-management  \n**Generated:** ${new Date().toISOString()}  \n**Description:** PMO/PMBOK-compliant Program Risk Register for enterprise and cross-project risk management\n\n---\n\n## 1. Program Risk Management Summary\n\n- **Program Name:** ${programName}\n- **Program Manager:** ${programManager}\n- **Charter Date:** ${charterDate}\n\n### Purpose\nThis Program Risk Register identifies, analyzes, and documents all risks that could impact program objectives, value delivery, or cross-project success. It serves as the central repository for risk information at the program level and provides the foundation for risk response planning and monitoring across the program lifecycle.\n\n---\n\n## 2. Program Risk Register\n\n### High-Priority Program Risks (Score: 11-25)\n\n| Risk ID | Risk Description | Category | Probability | Impact | Risk Score | Risk Owner | Mitigation Strategy | Status |\n|---------|------------------|----------|-------------|--------|------------|------------|---------------------|--------|\n| [AI_TO_POPULATE] | [AI: Identify highest-probability, high-impact risks that affect multiple projects or the program as a whole] | [AI: Strategic/Operational/External/Organizational/Financial] | [AI: 1-5] | [AI: 1-5] | [AI: Calculate] | [AI: Suggest appropriate owner] | [AI: Concrete mitigation actions] | Open |\n\n### Medium-Priority Program Risks (Score: 6-10)\n\n| Risk ID | Risk Description | Category | Probability | Impact | Risk Score | Risk Owner | Mitigation Strategy | Status |\n|---------|------------------|----------|-------------|--------|------------|------------|---------------------|--------|\n| [AI_TO_POPULATE] | [AI: Identify moderate risks with program-wide implications] | [AI: Category] | [AI: 1-5] | [AI: 1-5] | [AI: Calculate] | [AI: Owner] | [AI: Strategy] | Open |\n\n### Low-Priority Program Risks (Score: 1-5)\n\n| Risk ID | Risk Description | Category | Probability | Impact | Risk Score | Risk Owner | Mitigation Strategy | Status |\n|---------|------------------|----------|-------------|--------|------------|------------|---------------------|--------|\n| [AI_TO_POPULATE] | [AI: Identify lower-probability or low-impact risks for monitoring at the program level] | [AI: Category] | [AI: 1-5] | [AI: 1-5] | [AI: Calculate] | [AI: Owner] | [AI: Strategy] | Open |\n\n---\n\n## 3. Program Risk Category Analysis\n\n### Strategic Risks\n[AI: Analyze risks to program alignment with organizational strategy, value delivery, and long-term objectives]\n\n### Cross-Project Risks\n[AI: Identify risks that span multiple projects, dependencies, or shared resources]\n\n### Operational Risks\n[AI: Analyze resource, process, and operational risks at the program level]\n\n### External Risks\n[AI: Analyze market, regulatory, vendor, and environmental risks affecting the program]\n\n### Organizational Risks\n[AI: Analyze governance, stakeholder, and change management risks at the program level]\n\n### Financial Risks\n[AI: Analyze budget, funding, and financial risks with program-wide impact]\n\n---\n\n## 4. Program Risk Response Strategies\n\n- **Avoid**: Eliminate the threat by changing program approach\n- **Mitigate**: Reduce probability or impact of the risk\n- **Transfer**: Shift risk responsibility to third party\n- **Accept**: Acknowledge risk and plan contingency response\n\n### Contingency Plans\n\n| Risk ID | Trigger Events | Contingency Response | Resources Required | Timeline |\n|---------|---------------|---------------------|-------------------|----------|\n| [AI_TO_POPULATE] | [AI: Specific conditions that trigger response] | [AI: Detailed response actions] | [AI: Required resources] | [AI: Response timeline] |\n\n---\n\n## 5. Program Risk Monitoring and Control\n\n- **Risk Review Schedule**: Monthly program risk reviews, quarterly risk audits\n- **Key Risk Indicators (KRIs)**: [AI: Define program-level KRIs]\n- **Escalation Criteria**: Escalate critical risks to program steering committee or executive sponsors\n\n---\n\n## 6. Organizational Context for Program Risk Management\n\n- **Enterprise Environmental Factors (EEFs)**: [AI: Identify industry, market, and regulatory factors impacting the program]\n- **Organizational Process Assets (OPAs)**: [AI: Reference program-level risk management processes, templates, and tools]\n- **Risk Tolerance**: [AI: Define program risk tolerance and thresholds]\n\n---\n\n## 7. Instructions for Program Risk Register Completion\n\n- Conduct program-level risk workshops with project managers and key stakeholders\n- Review cross-project dependencies and shared resource risks\n- Update the register regularly as new risks emerge or are resolved\n- Ensure all program risks are assigned owners and mitigation strategies\n\n---\n\n**Document Control:**  \n- **Version**: 1.0  \n- **Last Updated**: ${new Date().toISOString()}  \n- **Next Review**: [Schedule based on program phase]  \n- **Owner**: [Program Manager Name]  \n- **Approver**: [Program Steering Committee or Executive Sponsor]\n\n*This Program Risk Register was generated by synthesizing program context, cross-project dependencies, and organizational strategy. Please review, validate, and complete the organizational sections to ensure comprehensive risk coverage.*\n`;
  }
}
